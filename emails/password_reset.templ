package emails

import (
	"context"
	"github.com/MBvisti/mortenvistisen/config"
)

type PasswordReset struct {
	ResetLink string
}

var _ TemplateHandler = (*PasswordReset)(nil)

func (p PasswordReset) Generate(ctx context.Context) (Html, Text, error) {
	html, plainText, err := processEmail(ctx, p.template())
	if err != nil {
		return Html(""), Text(""), err
	}

	return Html(html), Text(plainText), nil
}

templ (p PasswordReset) template() {
	<style>
p {
color: black;
}
</style>
	@base() {
		@header("A password reset has been request")
		<tr>
			<td>
				<p>You recently requested to reset your password for your { config.Cfg.ProjectName } account. Use the link below to reset it. <strong>This password reset link is only valid for the next hour.</strong></p>
			</td>
		</tr>
		<tr>
			<td style="padding-bottom: 10px;">
				@link(linkProps{text: "Reset password", url: p.ResetLink})
			</td>
		</tr>
		<tr>
			<td>
				<p>
					If you did not request a password reset, please ignore this email.
				</p>
			</td>
		</tr>
		@footer()
	}
}
