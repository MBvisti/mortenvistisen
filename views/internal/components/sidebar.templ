package components

import (
	"github.com/mbvisti/mortenvistisen/router/routes"
	"strings"
)

func isActive(currentPath, sectionPath string) bool {
	// For dashboard: exact match only
	if sectionPath == "/dashboard" {
		return currentPath == "/dashboard"
	}
	// For other sections: path starts with section
	return strings.HasPrefix(currentPath, sectionPath)
}

templ SideBar(currentPath string) {
	<!-- Sidebar -->
	<aside class="sidebar lg:static fixed top-0 left-0 h-screen w-[280px] z-50 -translate-x-full lg:translate-x-0" id="sidebar">
		<div class="sidebar-header">
			<h2 class="sidebar-brand">Grafto</h2>
		</div>
		<nav>
			<ul class="list-none p-0 m-0 py-4">
				<li class="mb-1">
					<a href={ templ.SafeURL(routes.DashboardHome.Path) } class={ "sidebar-nav-item", templ.KV("active", isActive(currentPath, "/dashboard")) }>
						<span class="sidebar-nav-icon">ğŸ“Š</span>
						Dashboard
					</a>
				</li>
				<li class="mb-1">
					<a href="/dashboard/tags" class={ "sidebar-nav-item", templ.KV("active", isActive(currentPath, "/dashboard/tags")) }>
						<span class="sidebar-nav-icon">ğŸ·ï¸</span>
						Tags
					</a>
				</li>
				<li class="mb-1">
					<a href={ templ.SafeURL(routes.DashboardNewsletters.Path) } class={ "sidebar-nav-item", templ.KV("active", isActive(currentPath, "/dashboard/newsletters")) }>
						<span class="sidebar-nav-icon">ğŸ“°</span>
						Newsletters
					</a>
				</li>
				<li class="mb-1">
					<a href={ templ.SafeURL(routes.DashboardSubscribers.Path) } class={ "sidebar-nav-item", templ.KV("active", isActive(currentPath, "/dashboard/subscribers")) }>
						<span class="sidebar-nav-icon">ğŸ“§</span>
						Subscribers
					</a>
				</li>
			</ul>
		</nav>
	</aside>
}
